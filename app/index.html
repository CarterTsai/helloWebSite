<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Web Site Testing</title>
  </head>
  <body>
    <script>
        var request = require("request");
        var schedule = require('node-schedule');
        var moment = require('moment-timezone');
        var count = 0;
        var y = schedule.scheduleJob('*/1 * * * * *', function(){
            var nowDom = document.querySelector(".list .now");
            nowDom.innerHTML = moment().tz("Asia/Taipei").format("h:mm:ss a");
        });

        var j = schedule.scheduleJob('*/30 * * * * *', function(){
            count += 1;
            request('https://www.chung-yo.com', function (error, response, body) {
                var list_success = document.querySelector(".list .success");
                if (!error && response.statusCode == 200) {
                    list_success.innerHTML = "網站目前正常！"+ count +" 狀態" + response.statusCode;
                } else {
                    list_success.innerHTML = "網站目前有異常 狀態" + response.statusCode;
                }
            })
        });
    </script>
    <div class="list">
        <h1 class="now"></h1>
        <h3>Update Status during 30 second </h3>
        <h1 class="success"></h1>
    </div>

  </body>
</html>
